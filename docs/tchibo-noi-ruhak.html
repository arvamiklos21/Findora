<!DOCTYPE html>
<html lang="hu">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Tchibo n≈ëi ruh√°k ‚Äì Akci√≥k √©s kedvezm√©nyek | Findora</title>
  <meta name="description" content="V√°logass a Tchibo n≈ëi ruh√°k k√≠n√°lat√°b√≥l: nadr√°gok, pul√≥verek, kab√°tok, fels≈ëk √©s akci√≥k egy helyen a Findora.hu-n." />
  <link rel="canonical" href="https://www.findora.hu/tchibo-noi-ruhak.html" />
  <link rel="icon" href="assets/img/findora_mark.png" />
  <link rel="stylesheet" href="assets/css/style.css" />
  <style>
    .wrap{max-width:1200px;margin:0 auto;padding:16px}
    .topbar{display:flex;gap:16px;align-items:center;justify-content:space-between;flex-wrap:wrap;margin-bottom:8px}
    nav.menu{display:flex;gap:14px;flex-wrap:wrap}
    nav.menu a{text-decoration:none;color:#1a73e8;font-weight:600}
    nav.menu a:hover{text-decoration:underline}

    .back-home{display:inline-block;text-decoration:none;color:#1a73e8;font-weight:600}
    .back-home:hover{text-decoration:underline}

    .grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(220px,1fr));gap:16px}
    .card{background:#fff;border-radius:14px;padding:12px;box-shadow:0 4px 16px rgba(0,0,0,.06);display:flex;flex-direction:column}
    .thumb{height:180px;display:flex;align-items:center;justify-content:center;margin-bottom:8px}
    .thumb img{max-height:100%;max-width:100%;object-fit:contain}
    .title{font-weight:600;margin-bottom:6px}
    .price{font-weight:700;margin-top:auto}
    .cta a{display:inline-block;margin-top:10px;padding:10px 14px;border-radius:12px;background:#1a73e8;color:#fff;text-decoration:none}
    .muted{color:#64748b;font-size:.9rem}

    .toolbar{display:flex;gap:10px;align-items:center;flex-wrap:wrap;margin:10px 0 18px}
    .pill{padding:6px 10px;border:1px solid #e2e8f0;border-radius:999px;background:#fff}
    .pill select, .pill input{border:none;outline:none;background:transparent}
    .pager{display:flex;gap:8px;justify-content:center;margin:22px 0}
    .pager button{padding:8px 12px;border-radius:10px;border:1px solid #e2e8f0;background:#fff;cursor:pointer}

    /* Lebeg≈ë ‚ÄúVissza a f≈ëoldalra‚Äù gomb (2/3) */
    .floating-home{
      position:fixed;right:16px;bottom:16px;z-index:50;
      background:#1a73e8;color:#fff;border-radius:999px;padding:10px 14px;
      text-decoration:none;box-shadow:0 10px 24px rgba(0,0,0,.18);
    }
    .floating-home:hover{filter:brightness(1.05)}
    footer{margin:28px 0 10px}
    .legal{color:#6b7280;font-size:.85rem}
  </style>

  <!-- Struktur√°lt adat a list√°hoz -->
  <script type="application/ld+json">
  {
    "@context":"https://schema.org",
    "@type":"CollectionPage",
    "name":"Tchibo n≈ëi ruh√°k ‚Äì Akci√≥k √©s kedvezm√©nyek",
    "breadcrumb":{
      "@type":"BreadcrumbList",
      "itemListElement":[
        {"@type":"ListItem","position":1,"name":"Findora","item":"https://www.findora.hu/"},
        {"@type":"ListItem","position":2,"name":"Tchibo n≈ëi ruh√°k","item":"https://www.findora.hu/tchibo-noi-ruhak.html"}
      ]
    }
  }
  </script>
</head>
<body>
  <div class="wrap">
    <div class="topbar">
      <!-- MEN√úSOR a f≈ëoldal szekci√≥ira mutatva -->
      <nav class="menu" aria-label="F≈ë navig√°ci√≥">
        <a href="https://www.findora.hu/">üè† F≈ëoldal</a>
        <a href="https://www.findora.hu/#otthon">Otthon</a>
        <a href="https://www.findora.hu/#sport">Sport</a>
        <a href="https://www.findora.hu/#jatekok">J√°t√©kok</a>
        <a href="https://www.findora.hu/#tech">Tech</a>
        <a href="https://www.findora.hu/#akciok">Akci√≥k</a>
      </nav>

      <!-- Vissza a f≈ëoldalra (1/3) -->
      <a href="https://www.findora.hu" class="back-home">‚Üê Vissza a f≈ëoldalra</a>
    </div>

    <h1>Tchibo n≈ëi ruh√°k</h1>
    <div class="muted">V√°logatott n≈ëi ruh√°k a Tchibo k√≠n√°lat√°b√≥l. Az √°rak √©s k√©szletek 2 √≥r√°nk√©nt friss√ºlnek.</div>

    <!-- SZ≈∞R≈êK + RENDEZ√âS -->
    <div class="toolbar" role="region" aria-label="Sz≈±r≈ëk √©s rendez√©s">
      <span class="pill">Kulcssz≈±r≈ë: n≈ëi / ruha / szoknya / nadr√°g / pul√≥ver / kab√°t</span>
      <label class="pill"><input id="onlyDiscount" type="checkbox" /> Csak akci√≥s</label>
      <label class="pill">Min. kedvezm√©ny:
        <input id="minDisc" type="number" min="0" max="90" step="5" value="0" style="width:70px" />%
      </label>

      <!-- √öJ: Kateg√≥ria sz≈±r≈ë -->
      <label class="pill">Kateg√≥ria:
        <select id="category">
          <option value="osszes">√ñsszes</option>
          <option value="szoknya">Szoknya</option>
          <option value="nadrag">Nadr√°g</option>
          <option value="pulover">Pul√≥ver</option>
          <option value="kabat">Kab√°t</option>
          <option value="polo">P√≥l√≥</option>
          <option value="zokni">Zokni</option>
          <option value="fehernemu">Feh√©rnem≈±</option>
        </select>
      </label>

      <!-- √öJ: √År szerinti rendez√©s -->
      <label class="pill">Rendez√©s:
        <select id="sortBy" aria-label="Rendez√©s √°r szerint">
          <option value="price-asc">√År: alacsonyt√≥l ‚Üí magasig</option>
          <option value="price-desc">√År: magast√≥l ‚Üí alacsonyig</option>
        </select>
      </label>
    </div>

    <div id="grid" class="grid" aria-live="polite"></div>
    <div class="pager">
      <button id="prevBtn" disabled>El≈ëz≈ë</button>
      <span id="pageInfo" class="muted">1. oldal (dinamikus bet√∂lt√©s)</span>
      <button id="nextBtn">K√∂vetkez≈ë</button>
    </div>

    <!-- L√°bl√©c ‚ÄúVissza a f≈ëoldalra‚Äù (3/3) -->
    <footer>
      <p><a class="back-home" href="https://www.findora.hu">‚Üê Vissza a f≈ëoldalra</a></p>
      <p class="legal">A Findora.hu affiliate linkeket tartalmaz. A linkekre kattintva v√°s√°rl√°s eset√©n jutal√©kot kaphatunk; ez a v√°s√°rl√≥ sz√°m√°ra nem jelent pluszk√∂lts√©get.</p>
    </footer>
  </div>

  <!-- Lebeg≈ë f≈ëoldal-gomb (2/3) -->
  <a class="floating-home" href="https://www.findora.hu" aria-label="Vissza a f≈ëoldalra">‚Üê F≈ëoldal</a>

  <script>
    // ===== Be√°ll√≠t√°sok (index.html-hez nem ny√∫lunk) =====
    const FEED_BASE = '/feeds/tchibo';
    const MAX_PAGES_TO_SCAN = 1000;
    const PAGE_SIZE = 20;

    let currentPage = 1;  // vizu√°lis lapoz√≥
    let feedPage = 1;     // t√©nyleges page-XXXX.json sz√°ml√°l√≥

    const grid = document.getElementById('grid');
    const pageInfo = document.getElementById('pageInfo');
    const prevBtn = document.getElementById('prevBtn');
    const nextBtn = document.getElementById('nextBtn');
    const onlyDiscountEl = document.getElementById('onlyDiscount');
    const minDiscEl = document.getElementById('minDisc');
    const sortByEl = document.getElementById('sortBy');
    const categoryEl = document.getElementById('category');

    // Fogalom-kulcsszavak (HU √©kezetbiztos)
    const KW = ['n≈ëi','ruha','ruh√°zat','szoknya','nadr√°g','pul√≥ver','fels≈ë','kab√°t','bl√©zer','kardig√°n','leggings','tunika','ruhadarab','trik√≥','bl√∫z','overall','pizsama'];

    // Kateg√≥ria kulcsok ‚Üí mint√°k
    const CAT_PATTERNS = {
      szoknya: ['szoknya'],
      nadrag: ['nadr√°g','nadrag','leggings','farmer','pantall√≥','pantallo'],
      pulover: ['pul√≥ver','pulover','kardig√°n','kardigan','fels≈ë','felso','hoodie','kapucnis'],
      kabat: ['kab√°t','kabat','dzseki','mell√©ny','melleny','ballonkab√°t','ballonkabat'],
      polo: ['p√≥l√≥','polo','top','trik√≥','triko','bl√∫z','bluz','ing'],
      zokni: ['zokni','harisnya','harisnyanadr√°g','harisnyanadrag'],
      fehernemu: ['feh√©rnem≈±','fehernemu','melltart√≥','melltarto','bugyi','als√≥','also','body']
    };

    const toLower = s => (s || '').toLocaleLowerCase('hu-HU');

    // Sz≈±r√©s n≈ëi ruh√°kra (alap)
    function isNoiRuha(p) {
      const t = toLower(p.title);
      const c = toLower(p.category || '');
      const tags = (p.tags || []).map(toLower).join(' ');
      const hay = `${t} ${c} ${tags}`;
      return KW.some(k => hay.includes(k)) || hay.includes('n≈ëi ');
    }

    // Kateg√≥ria-illeszt√©s
    function matchesCategory(p, catKey){
      if (catKey === 'osszes') return true;
      const hay = `${toLower(p.title)} ${toLower(p.category||'')} ${(p.tags||[]).map(toLower).join(' ')}`;
      const pats = CAT_PATTERNS[catKey] || [];
      return pats.some(k => hay.includes(k));
    }

    // Deeplink √©p√≠t√©s
    function deeplink(url) {
      try { return `/api/dl?u=${encodeURIComponent(url)}&p=tchibo`; }
      catch { return url; }
    }

    // √År kinyer√©se sz√°mk√©nt
    function priceNum(p) {
      if (p == null || p === '') return NaN;
      const num = String(p).replace(/[^\d.]/g,'');
      return num ? Number(num) : NaN;
    }
    function priceFmt(p) {
      const n = priceNum(p);
      if (isNaN(n)) return '';
      return new Intl.NumberFormat('hu-HU').format(n) + ' Ft';
    }

    function cardHTML(it){
      const img = it.image || it.img || it.imageUrl || '';
      const discount = it.discount || it.sale_percent || it.salePercent || null;
      const price = it.price || it.price_huf || it.final_price || '';
      return `
        <div class="card">
          <div class="thumb">
            <img loading="lazy" src="${img}" alt="${(it.title||'Tchibo term√©k').replace(/"/g,'&quot;')}" />
          </div>
          <div class="title">${it.title || 'Term√©k'}</div>
          <div class="muted">${it.partner || 'Tchibo.hu'}${discount ? ` ‚Ä¢ ‚àí${discount}%` : ''}</div>
          <div class="price">${priceFmt(price)}</div>
          <div class="cta"><a href="${deeplink(it.url || it.link || '')}" target="_blank" rel="nofollow sponsored noopener noreferrer">Megn√©zem</a></div>
        </div>`;
    }

    async function fetchFeedPage(n){
      const url = `${FEED_BASE}/page-${String(n).padStart(4,'0')}.json`;
      const res = await fetch(url,{cache:'no-store'});
      if (!res.ok) return null;
      try { return await res.json(); } catch { return null; }
    }

    async function renderPage(direction){
      grid.innerHTML = '';
      let collected = [];
      let scanned = 0;
      const need = PAGE_SIZE;

      if (direction < 0) feedPage = Math.max(1, feedPage - 2);

      while (collected.length < need && scanned < MAX_PAGES_TO_SCAN){
        const data = await fetchFeedPage(feedPage);
        scanned++;
        feedPage++;

        if (!data) break;

        let items = Array.isArray(data.items) ? data.items : [];
        // Alapsz≈±r√©s: n≈ëi ruh√°k
        items = items.filter(isNoiRuha);
        // Kateg√≥ria-sz≈±r√©s
        const catKey = categoryEl.value;
        items = items.filter(p => matchesCategory(p, catKey));
        // Akci√≥ sz≈±r√©s
        const onlyDiscount = onlyDiscountEl.checked;
        const minDisc = parseInt(minDiscEl.value || '0', 10);
        if (onlyDiscount || minDisc > 0){
          items = items.filter(x => {
            const d = Number(x.discount || x.sale_percent || x.salePercent || 0);
            return (onlyDiscount ? d > 0 : true) && d >= minDisc;
          });
        }
        collected.push(...items);

        if (!data.nextPage) break;
      }

      // Rendez√©s √°r szerint
      const sortBy = sortByEl.value;
      collected.sort((a,b) => {
        const pa = priceNum(a.price || a.price_huf || a.final_price || '');
        const pb = priceNum(b.price || b.price_huf || b.final_price || '');
        if (isNaN(pa) && isNaN(pb)) return 0;
        if (isNaN(pa)) return 1;
        if (isNaN(pb)) return -1;
        return sortBy === 'price-asc' ? (pa - pb) : (pb - pa);
      });

      const slice = collected.slice(0, need);
      grid.innerHTML = slice.map(cardHTML).join('') || `<div class="muted">Nem tal√°ltunk a sz≈±r≈ëre illeszked≈ë term√©ket.</div>`;

      pageInfo.textContent = `${currentPage}. oldal ‚Ä¢ megjelen√≠tve: ${slice.length} t√©tel ‚Ä¢ beolvasott feed-oldalak: ${scanned}`;
      prevBtn.disabled = currentPage <= 1;
    }

    // Esem√©nyek
    nextBtn.addEventListener('click', () => { currentPage++; renderPage(+1); });
    prevBtn.addEventListener('click', () => { if (currentPage>1){ currentPage--; renderPage(-1); }});
    [onlyDiscountEl, minDiscEl, sortByEl, categoryEl].forEach(el => {
      el.addEventListener('change', () => { currentPage=1; feedPage=1; renderPage(0); });
      el.addEventListener('input',  () => { currentPage=1; feedPage=1; renderPage(0); });
    });

    // Start
    renderPage(0);
  </script>
</body>
</html>
